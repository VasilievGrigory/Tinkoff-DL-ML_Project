# Tinkoff-DL-ML_Project
Входной проект на курсы от Тинькофф по DL/ML.

В этой работе я реализовал два вида проверки работ на плагиат: расстояние Левенштейна и косинусное расстояние после преобразования с помощью BERT. Я не совсем понял, что значит не использовать сторонних библиотек, ведь почти всё связанное с машинным обучением являются в каком-то роде сторонней библиотекой. Поэтому импорты для использования BERT лежат в самой функции преобразования текстов и не участвуют в рассчете расстояния Левенштейна. 

Тем самым алгоритм позволяет получить обычное расстояние Левенштейна после некоторой нормализации текстов, а точнее после замены всех переменных на некоторые нейтральные и уничтожению всех комментариев и docstrings. Переменные я меняю следующим образом: каждую новую переменную, появившуюся в скрипте, заменяю на некоторое количество одинаковых букв английского алфавита, например, 'aaa'. После, если появилась еще 1 новая переменная, меняю на 'aaaa', и так далее до 40 литералов. После меняю букву на следующую. Также, понятно, заменял уже появившиеся ранее переменные тоже. Запоминал контексты разных функций и глобальный. В целом, это всё, я также написал подробные комментарии в коде нормализации, если что-то непонятно.

После от этих текстов вычислял расстояние Левенштейна и после преобразования BERT, вычислял косинусное расстояние. Есть три опции: расстояние Левенштейна, косинусное расстояние, их среднее.

Как видно, в моей работе 3 файла. Опишу как работать с каждым из них.

# normalizer.py
С этим файлом все просто, с ним ничего делать не нужно, он используется, чтобы преобразовывать тексты в двух других файлах.

# train.py
Нужен для того, чтобы создать обучающую директорию. В описании к работе нужно было сохранять именно модель, но так как я по факту никакую модель не обучаю, мне нужно сохранять именно предобработанные тексты, чтобы в дальнейшем использовать их для совместного преобразования с полученными от пользователя текстами в compare.py. Поэтому логика работы здесь такая:
```Ruby
python3 train.py files plagiat1 plagiat2
```
ВАЖНО!
Преобразованные тексты будут сохранены в локальную папку train/. Преобразование можно не проводить, если нужно только расстояние Левенштейна.

# compile.py
Основной файл. Возвращает искомые расстояния, синтаксис такой же, как описан в задание, только есть некоторые дополнительные опции.

Скрипт вернет расстояние Левенштейна пар скриптов из input.txt в scores.txt:
```Ruby
python3 compile.py input.txt scores.txt
```

Скрипт вернет косинусное расстояние пар скриптов из input.txt в scores.txt:
```Ruby
python3 compile.py input.txt scores.txt --model 1
```

Скрипт вернет среднее расстояний Левештейна и косинусного пар скриптов из input.txt в scores.txt:
```Ruby
python3 compile.py input.txt scores.txt --model 1 --mean 1
```
